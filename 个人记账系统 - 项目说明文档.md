# 个人记账系统 - 项目说明文档

## 项目概述

**个人记账系统**是一个基于 Web 的全栈应用，帮助用户轻松管理个人财务，记录收支情况，分析消费习惯，并设置预算提醒。

### 核心功能
- 用户注册登录系统
- 收支记录管理
- 多分类记账
- 数据统计可视化
- 预算管理
- 数据导出备份

### 技术栈
- **前端**: HTML5 + CSS3 + JavaScript (ES6+)
- **后端**: Node.js + Express.js
- **数据库**: SQLite
- **认证**: JWT (JSON Web Tokens)

---

## 项目结构

```
my-finance-app/
├── backend/                 # 后端服务
│   ├── node_modules/
│   ├── server.js              # 服务器主文件
│   ├── package.json           # 后端依赖配置
│   ├── package-lock.json
│   ├── .env                   # 环境变量配置
│   ├── finance.db             # SQLite数据库文件
│   └── seed-data.js           # 样例数据生成脚本
├── frontend/               # 前端界面
│   ├── debug.html             # 查看连接及测试页面
│   ├── index.html             # 主应用页面
│   ├── login.html             # 登录注册页面
│   ├── style.css              # 样式文件
│   ├── script.js              # 主业务逻辑
│   └── api.js                 # API接口封装
└── 个人记账系统-项目说明文档.md                  # 项目说明文档
```

---

## 快速开始

### 环境要求
- Node.js 16.0+
- npm 
- 现代浏览器（Chrome/Firefox/Safari/Edge）

### 安装和运行

#### 1. 启动后端服务
```bash
# 进入后端目录
cd backend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```
后端服务运行在：**http://localhost:5000**

#### 2. 启动前端服务
```bash
# 进入前端目录
cd frontend

# 启动本地服务器（选择一种方式）
python -m http.server 8000
# 或
npx http-server -p 8000
# 或使用 Live Server (VSCode扩展)
```
前端访问地址：**http://localhost:8000**

---

## 配置说明

### 后端环境配置 (.env)
```env
NODE_ENV=development
PORT=5000
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRE=30d
BCRYPT_SALT_ROUNDS=12
```

### 数据库配置
- 使用 SQLite 数据库，无需额外安装
- 数据库文件：`finance.db`
- 自动创建表结构，无需手动初始化

---

## 功能详解

### 1. 用户认证
- **注册**: 用户名、邮箱、密码
- **登录**: 邮箱密码验证
- **会话管理**: JWT Token 自动续期
- **安全**: 密码加密存储

### 2. 记账功能
- **收入/支出记录**
- **多分类管理**:
  - 餐饮
  - 交通  
  - 购物
  - 娱乐
  - 医疗
  - 教育
  - 投资
  - 其他
- **多账户支持**:
  - 现金
  - 银行卡
  - 支付宝
  - 微信支付
  - 信用卡
  - 数字钱包

### 3. 数据统计
- **月度收支统计**
- **分类消费分析**
- **消费趋势图表**
- **预算使用情况**
- **日均消费计算**

### 4. 预算管理
- **月度预算设置**
- **预算进度可视化**
- **超支预警提醒**
- **多分类独立预算**

### 5. 数据管理
- **记录搜索筛选**
- **数据导出 (JSON格式)**
- **批量删除操作**
- **自动数据备份**

---

## API 接口文档

### 认证接口
| 方法 | 端点                 | 描述         | 参数                        |
| ---- | -------------------- | ------------ | --------------------------- |
| POST | `/api/auth/register` | 用户注册     | `username, email, password` |
| POST | `/api/auth/login`    | 用户登录     | `email, password`           |
| GET  | `/api/auth/me`       | 获取用户信息 | 需要 Token                  |

### 记录管理接口
| 方法   | 端点               | 描述         | 参数                                  |
| ------ | ------------------ | ------------ | ------------------------------------- |
| GET    | `/api/records`     | 获取记录列表 | `page, limit, type, category, search` |
| POST   | `/api/records`     | 创建新记录   | 记录数据对象                          |
| PUT    | `/api/records/:id` | 更新记录     | 记录数据对象                          |
| DELETE | `/api/records/:id` | 删除记录     | 记录ID                                |

### 统计分析接口
| 方法 | 端点                                 | 描述         | 参数          |
| ---- | ------------------------------------ | ------------ | ------------- |
| GET  | `/api/analytics/overview`            | 获取统计概览 | `year, month` |
| GET  | `/api/analytics/annual-report/:year` | 年度报告     | 年份          |

### 预算管理接口
| 方法 | 端点           | 描述         | 参数         |
| ---- | -------------- | ------------ | ------------ |
| GET  | `/api/budgets` | 获取预算列表 | -            |
| POST | `/api/budgets` | 设置预算     | 预算数据对象 |

---

## 界面特性

### 用户体验
- **响应式设计** - 支持手机和电脑访问
- **深色/浅色主题** - 一键切换
- **实时数据更新** - 自动刷新机制
- **快捷操作** - 快速记账按钮
- **加载状态提示** - 操作反馈明确
- **键盘快捷键** - 提升操作效率

### 视觉设计
- **现代化界面** - 卡片式布局
- **数据可视化** - 图表直观展示
- **智能提醒** - 预算预警提示
- **色彩分类** - 不同分类使用不同颜色

---

## 安全特性

- **密码加密**: 使用 bcrypt 加密存储
- **JWT 认证**: 安全的 token 验证机制
- **CORS 保护**: 跨域请求控制
- **输入验证**: 前后端双重验证
- **SQL 注入防护**: 参数化查询

---

## 数据模型

### 用户表 (users)
```sql
id, username, email, password, currency, monthly_budget, preferences, created_at
```

### 记录表 (records)
```sql
id, user_id, type, amount, currency, category, account, date, note, tags, created_at
```

### 预算表 (budgets)
```sql
id, user_id, category, amount, period, year, month, alerts_enabled, threshold, created_at
```

---

## 开发指南

### 添加新功能
1. 后端: 在 `server.js` 中添加新的路由和控制器
2. 前端: 在 `script.js` 中添加对应的业务逻辑
3. 样式: 在 `style.css` 中添加新的样式规则

### 自定义分类
修改 `getCategoryName()` 和 `getAccountName()` 函数来添加新的分类或账户类型。

### 数据库迁移
如需修改数据库结构，需要更新 `server.js` 中的表创建语句。

---

## 故障排除

### 常见问题

1. **端口占用错误**
   ```bash
   # 查找占用端口的进程
   netstat -ano | findstr :5000
   # 结束进程
   taskkill /PID <进程ID> /F
   ```

2. **依赖安装失败**
   ```bash
   # 清理缓存重新安装
   npm cache clean --force
   npm install
   ```

3. **数据库连接失败**
   - 检查 `finance.db` 文件是否存在
   - 确保有文件读写权限

4. **前端无法连接后端**
   - 确认后端服务正在运行
   - 检查 `api.js` 中的 `baseURL` 配置
   - 验证 CORS 设置

### 调试模式
访问 `http://localhost:8000/debug.html` 查看详细的系统状态信息。

---

## 更新日志

### v1.0.0 (当前版本)
- 用户注册登录系统
- 完整的记账功能
- 数据统计和可视化
- 预算管理功能
- 数据导出备份
- 响应式界面设计

### 计划功能
- 定期自动记账
- 移动端应用
- 云同步功能
- 标签系统
- 报表生成
- 消息推送提醒
